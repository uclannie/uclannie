<!DOCTYPE html>
<html>
    <head>
        <title>Annie Yu</title>
        <link rel = "stylesheet"
   type = "text/css"
   href = "stylesheet.css" />
        <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/annyang/2.6.0/annyang.min.js"></script>
        <script src="assets/typeit.js/dist/typeit.min.js" ></script>
        <script src="assets/buzz/buzz.min.js"></script>
<!--        <script src="https://cdn.jsdelivr.net/npm/typeit@VERSION_NUMBER/dist/typeit.min.js" ></script>-->
        <link href="https://fonts.googleapis.com/css?family=Josefin+Sans:400,400i,700" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Nanum+Gothic:400,700,800" rel="stylesheet">
        

        
<script>
var i = 0;
var errorCount = 0;
var dadTalking = false;
var timer = 0;
var sceneA = 0;
var sceneD = 0;
    
$( document ).ready(function() {  
//    short("", 500, "&quot;I'm ready&quot;");
//    var traffic = new buzz.sound("assets/traffic_short.mp3");
//    traffic.loop().play().fadeIn();
});

var firstPrompt = setTimeout(function(){short("", 500, "&quot;I'm ready&quot;");}, 0);
var timerAdd = setInterval(function(){
    timer += 1;
    if (timer > 60){
        restart();
        timer = 0;
    }
    //$("#prompt").text(timer + " seconds");
}, 1000);    
    
function restart(){
    i = 0;
    errorCount = 0;
    dadTalking = false;
    sceneA = 0;
    sceneD = 0;
    short("", 1000, "&quot;I'm ready&quot;");
    $("#dialogue").css("text-align", "left");
    new TypeIt('#dialogue').pause(500).type("<b>Welcome,</b> to begin the memory, please say ");
} 
    
if (annyang) {
  var commands = {
    "I'm (ready)": Dad,
      "I (want)": Annie,
      "(It's the one thing) I love doing": Dad,
      "I want to be honest (with you)": Annie,
      "I want to let you know (how I truly feel)":Dad,
      "I want to let you know how I feel":Dad,
      "No (that's not what I meant)":Annie,
      "I wasn't trying to start a fight":Dad,
      "(I'm not saying that) I don't want to work hard":Annie,
      "I just wanted to let you know (what I actually want to do)":Dad,
      "But there's no point in telling you (if it's just going to make you angry)":Annie,
      "It's okay (this conversation will be over soon)":Dad,
      "(I'm being) given a chance": thankyou,
      
  };

  annyang.addCommands(commands);

annyang.addCallback('result', function(phrases) {
    micFade();
    
  console.log("I think the user said: ", phrases[0]);
  console.log("But then again, it could be any of the following: ", phrases);
});
    
annyang.addCallback('resultNoMatch', function(phrases){
    var count;
    var responses = ["Hah? What did you say?", "I can't hear you. Speak up.", "Hah?"]
    $("#dialogue").css("text-align", "left");
    new TypeIt("#annie").pause(500).delete();
    new TypeIt("#name").pause(500).type("Dad");

    new TypeIt("#dialogue").pause(500).type(responses[i]);
    
    if (i < responses.length)
        i++;
    else
        i = 0;
    
    if(errorCount > 3){
        if (dadTalking)
            Annie();
        else
            Dad();
        errorCount = 0;
    }
});
    
  annyang.start();
}

window.TypeItDefaults.cursor = false;
window.TypeItDefaults.startDelete=true;
window.TypeItDefaults.speed=45;
    
function micFade(){
    $("#mic").css("opacity", 1);
    setTimeout(function(){$("#mic").css("opacity", .3);},1500);
}
    
function dad1(){
    var traffic = new buzz.sound("assets/traffic_short.mp3");
    traffic.loop().play().fadeIn();
    imgChange("steering.jpg");
    short("Dad", 17000, "&quot;...I want&quot;");
    new TypeIt('#dialogue').pause(4500).type("Hey, ").pause(1000).type("so you're graduating from school in a couple months.").pause(1500).delete().pause(1500).type("Do...").pause(500).delete(5).type("Do you know what you would want to do?");    
}

function dad2(){
    short("Dad", 5000, "&quot;I want to be honest with you...&quot;");
    new TypeIt("#dialogue").pause(500).type("......").pause(1500).delete(3).type("Hah?");
}

function dad3(){
    short("Dad", 8000, "&quot;No...that's not what I meant&quot;");
    new TypeIt("#dialogue", {speed:150}).pause(500).type("<b>Art!?</b> ").pause(1000).options({speed: 30}).type("Are you kidding? ").pause(500).options({speed: 15}).type("Artists are just lazy people who don’t want to work hard!").pause(500).delete().options({speed: 10}).type("You will <b>end up on the street</b> with that kind of thinking!");
}    

function dad4(){
    short("Dad", 8000, "&quot;I'm not saying that I don't want to work hard...&quot;");
    new TypeIt("#dialogue", {speed:80, deleteSpeed:10}).pause(500).type("What are you going to do?").pause(1000).delete().options({speed: 30}).type("<b>Paint all day!?</b>").pause(500).delete().options({speed: 15}).type("Artists are just lazy people who don’t want to work hard!");
}     

function dad5(){
    short("Dad", 5000, "&quot;But there's no point in telling you if it's just going to make you angry.&quot;");
    new TypeIt("#dialogue", {speed:10, deletSpeed:10,breakLines: true}).pause(500).type("........").pause(1000).options({speed: 100}).break().type("........").pause(500).options({speed: 150}).delete().type("........");
}     

function dad6(){
    short("Dad", 0, "");
    new TypeIt("#prompt").pause(8000).type("!").pause(500).delete().type("&quot;I'm being given a chance!&quot;");
    new TypeIt("#dialogue", {speed:150, deletSpeed:10}).pause(500).type("...").pause(1000).options({speed: 100}).type("What kind ").pause(1500).options({speed: 150}).type("of art?");
}   
    
function annie1(){
    imgChange("lookingdown.jpg");
    short("Annie", 7000, "&quot;It's the one thing I love doing.&quot;");
    new TypeIt("#dialogue").pause(3000).type("I...").pause(1500).delete().type("I want to pursue art.");
}    
    
function annie2(){
    short("Annie", 3000, "&quot;I want to let you know how I truly feel.&quot;");
    new TypeIt("#dialogue").pause(1000).type("I want to pursue art.");
}
    
function annie3(){
    short("Annie", 3000, "&quot;I wasn't trying to start a fight.&quot;");
    new TypeIt("#dialogue").pause(1000).type("...");
}

function annie4(){
    short("Annie", 3000, "&quot;I just wanted to let you know what I actually want to do.&quot;");
    new TypeIt("#dialogue").pause(2000).type("...");
}    

function annie5(){
    short("Annie", 3000, "&quot;It's okay. This conversation will be over soon.&quot;");
    new TypeIt("#dialogue").pause(2000).type("...");
}   

function thankyou(){
    short("",0,"");
    new TypeIt("#doze", {speed:150, deleteSpeed:50}).pause(1500).type("多謝").pause(4000).delete();
    $("#dialogue").css({"text-align":"center","left":"24%"});
    new TypeIt("#dialogue", {speed:100, deleteSpeed:50}).pause(5000).type("&quot;<b>doh jie</b>&quot;").pause(3000).delete().pause(500).type("&quot;<b>Thank you.</b>&quot;").pause(3000).delete();
}

function imgChange(source){
    var string = "assets/imgs/";
    string = string.concat(source);
    $("#bg").attr("src", string);
    $("#bg").fadeIn(2500);
    setInterval(function(){
        $("#bg").fadeOut(1000);
    }, 6000);
}    
    
function short(name, promptDelay, prompt)
    {
        if(name==="Dad")
            {
                $("#dialogue").css("text-align", "left");
                new TypeIt("#annie").pause(500).delete();
                new TypeIt("#name", {startDelete:true}).pause(500).type(name);
            }
        else if (name==="Annie")
            {
                $("#dialogue").css("text-align", "right");
                new TypeIt("#name").pause(500).delete();
                new TypeIt("#annie", {startDelete:true}).pause(500).type(name);
            }
        else if (name=="")
            {
                new TypeIt("#name").pause(500).delete();
                new TypeIt("#annie").pause(500).delete();
            }
        new TypeIt("#prompt").pause(promptDelay).type(prompt);
    }

function Annie(){
    dadTalking = false;
    sceneA += 1;
    switch(sceneA){
        case 1: 
            annie1();
            break;
        case 2:
            annie2();
            break;
        case 3:
            annie3();
            break;
        case 4:
            annie4();
            break;
        case 5:
            annie5();
            break;
        default:
            break;
                
    }
}
    
function Dad(){
    dadTalking = true;
    sceneD += 1;
    switch(sceneD){
        case 1: 
            dad1();
            break;
        case 2:
            dad2();
            break;
        case 3:
            dad3();
            break;
        case 4:
            dad4();
            break;
        case 5:
            dad5();
            break;
        case 6:
            dad6();
            break;
        default:
            break;
                
    }
}

   
</script>   
    </head>
    
    
    
    
    <body>
        
        <button type="button" onclick="Dad();">dad</button>
        <button type="button" onclick="Annie();">annie</button>
        <button type="button" onclick="thankyou();">end</button><br/>
        <span id="name"></span>
        <span id="annie"></span>
        <span id="dialogue"><b>Welcome,</b> to begin the memory, please say </span>
        <br/><br/><br/>
        <div id="promptContainer"><img id="mic"src="assets/mic.png"/><i><span id="prompt"></span></i></div>
        <span id="doze"></span>
        <div id="img"><img id="bg" src="assets/imgs/lookingdown.jpg"/></div>
        
    </body>
</html>